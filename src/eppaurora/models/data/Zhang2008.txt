#Appendix A
#Methods for using Tables 1 and 2.
#The steps required to use the Fourier coefficients in
#Tables 1 and 2 in calculating the model energy flux and
#mean energy of precipitating electrons in the auroral oval
#Table 1
#Epstein- Fourier coefficients for energy flux
#A B C D
# Kp 0 (Kp: 0.0-1.5)
Const 3.2402978 18.221647 2.8442195 1.8336810
Cos_1 1.3291109 6.0779378 0.2931214 -0.3873319
Cos_2 0.4209809 -1.3235271 -0.5383766 0.0094550
Cos_3 0.4779546 0.2553541 0.2728634 0.0548413
Cos_4 -0.3673774 0.0980007 0.2950094 -0.0113930
Cos_5 0.0557991 0.0075817 -0.0456968 -0.0434681
Cos_6 -0.0556684 -0.0050137 0.0073026 0.0562728
Sin_1 -0.1914775 1.3812608 0.8133630 0.1214365
Sin_2 0.0802700 -0.0211661 -0.3734801 -0.2901524
Sin_3 -0.4206442 -0.1240047 -0.0874247 0.2791531
Sin_4 -0.0354484 0.3415960 -0.0607254 -0.1764180
Sin_5 -0.2017480 -0.1074103 0.1679693 0.0400522
Sin_6 -0.0298214 0.2863931 -0.0456554 -0.1214534
# Kp 1 (Kp: 1.5-3.0)
Const 6.3011691 19.882410 2.9663179 1.8560835
Cos_1 3.2522103 6.5577617 0.8165399 -0.3102606
Cos_2 -0.2114976 -1.5086115 -0.3559603 0.0363061
Cos_3 0.3216365 0.5457940 0.3101074 0.0574751
Cos_4 -0.3236900 -0.0926016 0.0969373 -0.0304515
Cos_5 0.1705425 -0.0363445 -0.0530104 0.0657831
Cos_6 0.0919870 -0.0801630 -0.0685254 0.0046886
Sin_1 -0.6934043 1.6156140 0.7957589 -0.0660346
Sin_2 -0.1779372 -0.0385058 -0.4427029 -0.3614867
Sin_3 -0.3675894 -0.1844160 -0.1514768 0.1820734
Sin_4 -0.0095432 0.2427321 0.0079244 -0.1546944
Sin_5 -0.2508516 -0.1503851 0.1311359 0.0449006
Sin_6 -0.0501051 0.1889811 -0.0278058 -0.0735363
# Kp 2 (Kp: 3.0-4.5)
Const 9.5988037 21.479304 3.1926672 1.9755171
Cos_1 5.1430543 6.6075450 1.2270596 -0.3518031
Cos_2 -1.7371661 -1.2566572 -0.0054540 -0.0143734
Cos_3 -0.2230598 0.3451542 0.1229414 -0.0291659
Cos_4 0.0422935 -0.0564700 0.0573293 -0.0337693
Cos_5 -0.0122696 -0.1576626 -0.0562889 0.0388444
Cos_6 0.0080510 0.2253359 0.0956040 0.0575712
Sin_1 -0.6726416 1.2164832 0.4361579 -0.1477385
Sin_2 -0.0727642 -0.2300587 -0.5028849 -0.2390160
Sin_3 0.1200389 -0.3520732 -0.2906078 0.1048181
Sin_4 0.0465696 0.2226716 0.0514080 -0.1010366
Sin_5 -0.4557674 -0.0385575 0.0760109 -0.0255308
Sin_6 -0.1550104 0.1310600 0.0308203 -0.0628866
# Kp 3 (Kp: 4.5-6.0)
Const 12.246801 23.511121 3.7091436 2.1764069
Cos_1 7.0481969 6.1681312 1.3842879 -0.4713056
Cos_2 -3.0928509 -0.7124293 0.1899543 -0.0948302
Cos_3 -1.2935699 0.2640897 0.0647574 -0.1372124
Cos_4 0.0884275 -0.2602568 -0.0045988 -0.0509513
Cos_5 -0.0274394 0.0211500 0.0295777 0.0340843
Cos_6 -0.2723690 0.2260950 0.1237925 -0.0056936
Sin_1 -1.0729358 1.0434480 0.4866616 -0.2832799
Sin_2 0.1829594 -0.3088645 -0.4396647 -0.0853116
Sin_3 0.6604424 -0.6493409 -0.3368631 0.0876408
Sin_4 0.1005881 0.3886247 0.2038886 0.0708100
Sin_5 -0.3857214 -0.0406112 0.0022551 -0.0345108
Sin_6 -0.3237388 -0.0072146 0.0360084 -0.0328183
# Kp 4 (Kp: 6.0-8.0)
Const 17.185531 27.197799 5.1669995 2.5417068
Cos_1 11.323595 5.3379375 1.1495666 -0.6063337
Cos_2 -1.2885997 -1.1071272 0.0676676 0.0136708
Cos_3 -0.8853908 0.3888829 -0.1339100 -0.0624044
Cos_4 1.2169522 -0.4494379 -0.0978956 0.0024086
Cos_5 0.9936972 -0.2346430 -0.2247035 0.0623906
Cos_6 0.3355213 0.3541175 0.0702655 0.0125311
Sin_1 -1.8969096 -0.7900455 0.0107553 -0.3075880
Sin_2 -1.5002061 0.5940236 0.2318213 0.0774584
Sin_3 -0.4722835 -0.7037725 -0.1692764 -0.1040405
Sin_4 -1.8746630 0.4504852 0.5258857 -0.0402230
Sin_5 -0.8323257 0.2860252 0.1850265 -0.0989170
Sin_6 0.1062067 -0.4846608 -0.2689677 0.0636382
# Kp 5 (Kp: 8.0-10.)
Const 33.435440 30.688625 5.9308809 4.1004123
Cos_1 24.269584 3.9275374 0.3238901 -0.4237273
Cos_2 -4.0539849 -2.4440639 -0.9602533 -0.1556447
Cos_3 -5.0305214 1.8123949 0.2338884 0.2188714
Cos_4 -1.7500538 -0.2253542 0.4168486 -0.0093918
Cos_5 -0.8196342 0.4044060 -0.1198387 -0.0095218
Cos_6 -0.7520601 -1.2894243 -0.5288058 0.0896570
Sin_1 -5.9059449 -2.6264976 0.8511741 -0.6852183
Sin_2 -0.1670781 3.0068989 0.9358651 -0.0488459
Sin_3 2.8623939 -2.5030701 -1.2186771 0.3298003
Sin_4 0.9153974 0.7056867 0.1745191 0.1314771
Sin_5 1.5992821 -0.1550183 -0.3299605 -0.1826762
Sin_6 0.9162504 -0.7857376 -0.2456667 0.2985601

# Table 2
# Epstein- Fourier coefficients for mean energy
# A B C D
# Kp 0 (Kp: 0.0-1.5)
Const 7.5088404 18.622930 3.2261931 1.8188745
Cos_1 2.6287603 5.7324085 0.0827922 -0.3112791
Cos_2 -0.0450220 -1.3868862 -0.6557206 0.0162807
Cos_3 0.6539572 0.5080752 0.2457516 0.0193889
Cos_4 -0.9457612 -0.2046010 0.1278021 -0.1452522
Cos_5 0.2284535 0.2564687 0.0392661 -0.0234400
Cos_6 0.0857270 -0.2413532 -0.0626898 0.0795029
Sin_1 1.8046452 0.8410476 0.4596556 0.2625440
Sin_2 0.5823422 -0.2971944 -0.2923336 -0.1834317
Sin_3 0.1393766 -0.3119841 -0.2334998 0.2266602
Sin_4 -0.0723001 0.5859838 0.2180461 -0.1648118
Sin_5 -0.0662265 -0.5321336 -0.2216241 0.0763152
Sin_6 0.0432793 0.4358112 0.1371674 -0.0443683
# Kp 1 (Kp: 1.5-3.0)
Const 12.476319 20.246945 3.6281879 2.3277229
Cos_1 3.2499986 6.3272640 0.6698318 -0.4858124
Cos_2 -1.1075362 -1.4599147 -0.3852461 0.1280848
Cos_3 0.6225175 0.3086182 0.1095518 0.0089136
Cos_4 -0.3542281 -0.1153670 0.0526728 0.0276094
Cos_5 0.2671344 0.1107047 0.0057801 0.0238859
Cos_6 -0.3752618 -0.0009860 0.0285045 -0.0548770
Sin_1 1.4611384 1.6000042 0.6870284 -0.1301243
Sin_2 0.2284218 -0.7198501 -0.3840291 0.0340882
Sin_3 0.4288793 -0.1125998 -0.2271862 0.2046926
Sin_4 0.2506734 0.3105266 0.0346479 -0.1601615
Sin_5 -0.2895276 -0.0826342 0.0748516 0.0745035
Sin_6 -0.1769982 0.1807557 0.0362094 -0.0670459
# Kp 2 (Kp: 3.0-4.5)
Const 14.536892 22.098385 4.2861266 2.5432819
Cos_1 3.1305259 6.4013028 1.3105747 -0.7704928
Cos_2 -2.2871685 -1.5546237 -0.0704801 0.2164700
Cos_3 1.0862771 0.1599054 -0.2381700 0.0604332
Cos_4 0.1800945 0.0602462 0.0054845 -0.0363121
Cos_5 0.1225502 -0.2760174 -0.1155566 0.0435058
Cos_6 -0.1272493 0.3207505 0.1056014 -0.0323768
Sin_1 0.9704765 1.4036987 0.7597528 -0.3689676
Sin_2 -1.5718893 -0.3569569 0.0161295 0.0244136
Sin_3 0.4149740 -0.1294209 -0.2204513 0.0575181
Sin_4 0.7983046 0.1732968 -0.1373450 -0.0725929
Sin_5 -0.1199654 -0.0866559 0.0403870 0.1156904
Sin_6 -0.0197113 -0.1329233 -0.1831675 -0.0874685
# Kp 3 (Kp: 4.5-6.0)
Const 15.331818 25.003303 5.3349772 2.7809839
Cos_1 4.1810730 4.5250853 1.0679711 -0.3268181
Cos_2 -3.2206392 -0.8886874 0.3065835 -0.0343280
Cos_3 0.6871455 0.3283599 -0.1866135 0.0969452
Cos_4 0.0282788 -0.1830582 -0.0734927 -0.0494360
Cos_5 0.0993148 0.1314636 0.1240323 0.1423388
Cos_6 0.3725189 -0.1355825 -0.3131202 0.0096009
Sin_1 1.4101789 -0.1568086 0.1102321 -0.1550980
Sin_2 -2.6020856 1.6360826 1.1559140 -0.1344462
Sin_3 0.4061787 -1.2011198 -0.6349193 0.1635120
Sin_4 0.2637291 0.6574644 0.4102871 -0.1738405
Sin_5 -0.0483039 -0.4113837 -0.2488912 0.1343180
Sin_6 -0.1032221 0.1704081 0.1341458 -0.0425656
# Kp 4 (Kp: 6.0-8.0)
Const 12.711536 29.569787 8.9235846 3.1418689
Cos_1 4.9489144 2.0663746 -0.3959043 -0.1798111
Cos_2 -1.0776907 -0.8581226 0.2240828 0.3055958
Cos_3 -0.0211482 0.5545988 0.0910289 -0.2134250
Cos_4 0.5794038 -0.4939224 -0.7516799 0.2001867
Cos_5 -0.1073198 0.1338599 0.4166312 -0.1595720
Cos_6 0.8659962 -0.3565078 -0.6280915 0.1716463
Sin_1 0.8146984 -0.9584897 -0.5490000 -0.0065597
Sin_2 -1.7790744 1.3059783 1.7359490 -0.1868292
Sin_3 -0.4836395 -0.3825059 0.1860379 0.0732792
Sin_4 1.2052806 -0.0530653 -0.6072967 0.2371617
Sin_5 -0.2396832 -0.2381297 -0.1249757 -0.2952748
Sin_6 0.0526640 0.3266970 0.1939607 0.1567970
# Kp 5 (Kp: 8.0-10.)
Const 11.079053 34.861338 14.029090 3.4220465
Cos_1 4.1699214 0.5744557 -1.3842857 0.4028692
Cos_2 -0.9658989 -0.1541219 1.1574677 -0.2531135
Cos_3 0.0279207 0.0996518 -0.0873445 0.0106004
Cos_4 -0.4720379 0.3018352 -0.0615509 -0.0742099
Cos_5 -1.5195664 0.5499986 1.6123139 -0.3866223
Cos_6 -0.3379223 0.1188457 -0.1510271 0.0490352
Sin_1 0.1850361 -0.9399275 -0.9182647 0.0524233
Sin_2 0.9907980 0.7029813 2.3111699 0.0841725
Sin_3 1.8820018 -1.8050634 -3.7862923 0.5047521
Sin_4 -0.2299877 0.9825936 1.4829554 -0.1756267
Sin_5 0.1177325 -0.1316252 -0.5813177 0.0187723
Sin_6 0.4769764 -0.2683708 -0.5264568 0.1440127


# at a given location specified by MLT (in hours), Mlat
# (in degrees), and Kp (0-9) are:
# (1) Calculate angle and co-magnetic latitude x:
# angle = MLT * 2π / 24,
# x = 90 - |Mlat|
# (2) Find the Kp values at the center of the Kp bins in
# Tables 1 and 2:
# Kp_model = [0.75; 2.25; 3.75; 5.25; 7.00; 9.00].
# (3) Find the two adjacent Kp_model values (Kpm1 and
# Kpm2) that satisfy the following two conditions:
# a. if Kp40.75, Kpm1pKp and KppKpm2;
# b. if Kpo0.75, Kpm1 = 0.75, Kpm2 = 2.25.
# (4) Calculate Epstein fitting parameters (A, B, C, D) at
# Kpm1 and Kpm2:
# a. A = Σ{Fn cos(n * angle)+Gn sin(n * angle)}, where Fn and
# Gn are the Fourier coefficients for the parameter A
# (see Tables 1 and 2), the n ranges from 0 to 6.
# b. Note G0 is always 0.
# (5) Using the Epstein parameters (A, B, C, D) from step (4),
# calculate the model values Vm1 at Kpm1 and Vm2 at
# Kpm2 using the Epstein function, A exp((x-B)/C)/
# {1+exp((x-A)/D)}^2. The Vm1 and Vm2 can be either
# the energy flux (Qm1, Qm2) or the mean energy
# (Eom1 and Eom2), depending on the table used.
# (6) Do linear interpolation for the mean energy:
# a. Let f1 = (Kpm2-Kp)/(Kpm2-Kmp1),
# b. Let f2 = (Kp-Kpm1)/(Kpm2-Kpm1),
# c. The model mean energy Eo = f1*Eom1+f2*Eom2
# (7) Do nonlinear interpolation for the energy flux:
# a. Using Eqs. (1) and (2), calculate hemispheric power
# HP, HPm1, HPm2 at Kp, Kpm1, and Kpm2, respectively.
# b. Let f1 = (HPm2-HP)/(HPm2-HPm1),
# c. Let f2 = (HP-HPm1)/(HPm2-HPm1),
# d. The model energy flux Q = f1*Qm1+f2*Qm2.
